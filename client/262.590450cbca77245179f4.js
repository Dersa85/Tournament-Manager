"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[262],{3262:(W,O,l)=>{l.r(O),l.d(O,{ScoreboardsModule:()=>h});var B=l(9302),p=l(8583),f=l(3679),t=l(7716),S=l(2326),b=l(2238),L=l(2304),A=l(8295),D=l(9983),w=l(7441),x=l(1095),C=l(2458);function M(e,o){if(1&e&&(t.TgZ(0,"mat-option",10),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.Q6J("value",n),t.xp6(1),t.Oqu(n)}}let Y=(()=>{class e{constructor(n,r,i,a){this.socket=n,this.fb=r,this.dialogRef=i,this.boardService=a,this.form=this.fb.group({name:["",[f.kI.required]],board:["BestOf5Board",[f.kI.required]]})}createBoard(){console.log(this.form.value),this.socket.emit("createBoard",this.form.value),this.dialogRef.close()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(S.sk),t.Y36(f.qu),t.Y36(b.so),t.Y36(L.$))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-new-board-dialog"]],decls:18,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"mat-typography"],[3,"formGroup","submit"],["appearance","fill"],["matInput","","formControlName","name"],["formControlName","board","value","BestOf5Board"],[3,"value",4,"ngFor","ngForOf"],["align","end"],["mat-raised-button","","color","primary",3,"disabled"],["mat-raised-button","","mat-dialog-close",""],[3,"value"]],template:function(n,r){1&n&&(t.TgZ(0,"h1",0),t._uU(1,"Neues Board erstellen"),t.qZA(),t.TgZ(2,"div",1),t.TgZ(3,"form",2),t.NdJ("submit",function(){return r.createBoard()}),t.TgZ(4,"mat-form-field",3),t.TgZ(5,"mat-label"),t._uU(6,"Name"),t.qZA(),t._UZ(7,"input",4),t.qZA(),t.TgZ(8,"mat-form-field",3),t.TgZ(9,"mat-label"),t._uU(10,"Anzeigetafel"),t.qZA(),t.TgZ(11,"mat-select",5),t.YNc(12,M,2,2,"mat-option",6),t.qZA(),t.qZA(),t.TgZ(13,"mat-dialog-actions",7),t.TgZ(14,"button",8),t._uU(15,"Erstellen"),t.qZA(),t.TgZ(16,"button",9),t._uU(17,"Abbrechen"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(3),t.Q6J("formGroup",r.form),t.xp6(9),t.Q6J("ngForOf",r.boardService.BOARD_TYPES),t.xp6(2),t.Q6J("disabled",r.form.invalid))},directives:[b.uh,b.xY,f._Y,f.JL,f.sg,A.KE,A.hX,D.Nt,f.Fj,f.JJ,f.u,w.gD,p.sg,b.H8,x.lW,b.ZT,C.ey],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column}form[_ngcontent-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]{margin:0}"]}),e})();var F=l(7556),y=l(3423);function v(e,o){if(1&e&&(t.TgZ(0,"button",8),t._uU(1,"Steuerung"),t.qZA()),2&e){const n=t.oxw().$implicit;t.MGl("routerLink","./best-of-5/control/",n.key,"")}}function J(e,o){if(1&e&&(t.TgZ(0,"div",6),t.TgZ(1,"h3"),t._uU(2),t.qZA(),t.TgZ(3,"div"),t.YNc(4,v,2,1,"button",7),t.ALo(5,"async"),t.TgZ(6,"button",8),t._uU(7,"Punktetafel"),t.qZA(),t.qZA(),t.qZA()),2&e){const n=o.$implicit,r=t.oxw(3);t.xp6(2),t.hij("",n.value.name,":"),t.xp6(2),t.Q6J("ngIf",t.lcZ(5,3,r.authService.isLogged)),t.xp6(2),t.MGl("routerLink","./best-of-5/scoreboard/",n.key,"")}}function U(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"h2"),t._uU(2,"-Best of 5-"),t.qZA(),t.YNc(3,J,8,5,"div",5),t.ALo(4,"keyvalue"),t.BQk()),2&e){const n=t.oxw().ngIf;t.xp6(3),t.Q6J("ngForOf",t.lcZ(4,1,n))}}const E=function(){return{}};function $(e,o){if(1&e&&(t.ynx(0),t.YNc(1,U,5,3,"ng-container",1),t.ALo(2,"json"),t.ALo(3,"json"),t.BQk()),2&e){const n=o.ngIf;t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,n)!=t.lcZ(3,3,t.DdM(5,E)))}}function I(e,o){if(1&e&&(t.TgZ(0,"button",8),t._uU(1,"Steuerung"),t.qZA()),2&e){const n=t.oxw().$implicit;t.MGl("routerLink","./team-point/control/",n.key,"")}}function Q(e,o){if(1&e&&(t.TgZ(0,"div",6),t.TgZ(1,"h3"),t._uU(2),t.qZA(),t.YNc(3,I,2,1,"button",7),t.ALo(4,"async"),t.TgZ(5,"button",8),t._uU(6,"Punktetafel"),t.qZA(),t.qZA()),2&e){const n=o.$implicit,r=t.oxw(3);t.xp6(2),t.Oqu(n.value.name),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,3,r.authService.isLogged)),t.xp6(2),t.MGl("routerLink","team-point/scoreboard/",n.key,"")}}function G(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"h2"),t._uU(2,"-Team Point-"),t.qZA(),t.YNc(3,Q,7,5,"div",5),t.ALo(4,"keyvalue"),t.BQk()),2&e){const n=t.oxw().ngIf;t.xp6(3),t.Q6J("ngForOf",t.lcZ(4,1,n))}}function H(e,o){if(1&e&&(t.ynx(0),t.YNc(1,G,5,3,"ng-container",1),t.ALo(2,"json"),t.ALo(3,"json"),t.BQk()),2&e){const n=o.ngIf;t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,n)!=t.lcZ(3,3,t.DdM(5,E)))}}function z(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){return t.CHM(n),t.oxw().openNewBoardDialog()}),t._uU(1,"Neues Board"),t.qZA()}}const j=[{path:"",component:(()=>{class e{constructor(n,r,i,a,s){this.authService=n,this.socket=r,this.dialog=i,this.router=a,this.route=s,this.allBestOf5Boards$=this.socket.fromEvent("allBestOf5Boards"),this.allTeamPointBoards$=this.socket.fromEvent("allTeamPointBoards"),this.socket.emit("getAllBoards")}sendMessage(n){this.socket.emit("getScoreboard",n)}openNewBoardDialog(){this.dialog.open(Y)}navigateBack(){this.router.navigate(["./.."],{relativeTo:this.route})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(F.e),t.Y36(S.sk),t.Y36(b.uw),t.Y36(y.F0),t.Y36(y.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-overview"]],decls:12,vars:9,consts:[[1,"main"],[4,"ngIf"],[1,"nav-btn-container"],["mat-raised-button","",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click"],["class","board",4,"ngFor","ngForOf"],[1,"board"],["mat-stroked-button","","color","primary",3,"routerLink",4,"ngIf"],["mat-stroked-button","","color","primary",3,"routerLink"],["mat-raised-button","",3,"click"]],template:function(n,r){1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"h1"),t._uU(2,"Punktetafel \xdcbersicht"),t.qZA(),t.YNc(3,$,4,6,"ng-container",1),t.ALo(4,"async"),t.YNc(5,H,4,6,"ng-container",1),t.ALo(6,"async"),t.TgZ(7,"div",2),t.YNc(8,z,2,0,"button",3),t.ALo(9,"async"),t.TgZ(10,"button",4),t.NdJ("click",function(){return r.navigateBack()}),t._uU(11,"Zur\xfcck"),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(3),t.Q6J("ngIf",t.lcZ(4,3,r.allBestOf5Boards$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(6,5,r.allTeamPointBoards$)),t.xp6(3),t.Q6J("ngIf",t.lcZ(9,7,r.authService.isLogged)))},directives:[p.O5,x.lW,p.sg,y.rH],pipes:[p.Ov,p.Ts,p.Nd],styles:["[_nghost-%COMP%]{display:flex;justify-content:center}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:.5rem 0 0}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   .board[_ngcontent-%COMP%]{margin:0 0 .5rem;display:flex;align-items:center;justify-content:space-between;width:100%}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   .board[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   .board[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 0 0 1rem}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   .nav-btn-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   .nav-btn-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:1rem 0 0}"]}),e})()},{path:"best-of-5",loadChildren:()=>Promise.all([l.e(46),l.e(980)]).then(l.bind(l,3980)).then(e=>e.BestOf5Module)},{path:"team-point",loadChildren:()=>Promise.all([l.e(46),l.e(557)]).then(l.bind(l,557)).then(e=>e.TeamPointModule)}];let k=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[y.Bz.forChild(j)],y.Bz]}),e})();var P=l(4586),N=l(9557);let h=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[p.ez,N.q,k,P.D,f.UX,B.S]]}),e})()},2304:(W,O,l)=>{l.d(O,{$:()=>h});var Z=l(7716),j=l(6215),k=l(2759),P=l(8002),N=l(2326);let h=class{constructor(o){this.socket=o,this.SCOREBOARD_HEIGHT=180,this.SCOREBOARD_WIDTH=320,this.BOARD_TYPES=["BestOf5Board","TeamPointBoard"],this.soundBeginBattle=new Audio,this.soundEndBattle=new Audio,this.soundBreakTimeEnd=new Audio,this.soundBattleTimeEnds=new Audio,this.board$=new j.X(null),this.loadSounds(),this.checkTimeForSounds()}loadSounds(){this.soundBeginBattle.src="/assets/sounds/kampf_beginn.wav",this.soundEndBattle.src="/assets/sounds/kampf_ende.wav",this.soundBreakTimeEnd.src="/assets/sounds/pause_ende.wav",this.soundBattleTimeEnds.src="/assets/sounds/zeit_knapp.wav",this.soundBeginBattle.load(),this.soundEndBattle.load(),this.soundBreakTimeEnd.load(),this.soundBattleTimeEnds.load()}checkTimeForSounds(){let r=9999999999,i=9999999999;this.board$.subscribe(a=>{if(a){if(a.countdown){const s=a.countdown;s.timeLeft<s.totalTime&&r==s.totalTime&&this.soundBeginBattle.play(),s.timeLeft<=11e3&&r>11e3&&s.isTimeRunning&&this.soundBattleTimeEnds.play(),s.timeLeft==s.totalTime&&r<990&&this.soundEndBattle.play(),r=s.timeLeft}if(a.breakTime){const s=a.breakTime;s.timeLeft==s.totalTime&&i<990&&this.soundBreakTimeEnd.play(),i=s.timeLeft}}})}getCalcScale(o){const n=this.calcRatio(this.SCOREBOARD_WIDTH,o.offsetWidth),r=this.calcRatio(this.SCOREBOARD_HEIGHT,o.offsetHeight);return Math.min(n,r)}startCountdown(o){this.socket.emit("startCountdown",this.boardType,this.boardId,o)}stopCountdown(o){this.socket.emit("stopCountdown",this.boardType,this.boardId,o)}resetCountdown(o){this.socket.emit("resetCountdown",this.boardType,this.boardId,o)}updateTotalCountdown(o,n){this.socket.emit("updateTotalCountdown",this.boardType,this.boardId,o,n)}resetScoreboard(){this.socket.emit("resetScoreboard",this.boardType,this.boardId)}setRoundWinner(o){this.socket.emit("setWinner",this.boardType,this.boardId,o)}removeLastWinner(){this.socket.emit("removeLastWinner",this.boardType,this.boardId)}setScoreboardSize(o){const n=o.getElementsByClassName("scoreboard")[0];n.style.height=this.SCOREBOARD_HEIGHT+"px",n.style.width=this.SCOREBOARD_WIDTH+"px"}setBoard(o,n){this.boardType=o,this.boardId=n,this.unsubscribeBoard(),this.subscribeNewBoard(o,n),this.socket.emit("getBord",o,n)}setTransformScale(o){this.transformScale$=(0,k.R)(window,"resize").pipe((0,P.U)(n=>this.getCalcScale(o)),(0,P.U)(n=>`scale(${n})`)),setTimeout(()=>{this.setScoreboardSize(o),window.dispatchEvent(new Event("resize"))},1)}updateTeamPoints(o){this.socket.emit("updateTeamPoints",this.boardType,this.boardId,o)}get board(){return this.board$}get transformScale(){return this.transformScale$}calcRatio(o,n){return n/o}unsubscribeBoard(){this.boardSubsctiption&&this.boardSubsctiption.unsubscribe()}subscribeNewBoard(o,n){this.boardSubsctiption=this.socket.fromEvent(`board/${o}/${n}`).subscribe(r=>{this.board$.next(r)})}};h.\u0275fac=function(o){return new(o||h)(Z.LFG(N.sk))},h.\u0275prov=Z.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h=function(e,o,n,r){var s,i=arguments.length,a=i<3?o:null===r?r=Object.getOwnPropertyDescriptor(o,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,o,n,r);else for(var u=e.length-1;u>=0;u--)(s=e[u])&&(a=(i<3?s(a):i>3?s(o,n,a):s(o,n))||a);return i>3&&a&&Object.defineProperty(o,n,a),a}([(0,Z.GSi)()],h)}}]);