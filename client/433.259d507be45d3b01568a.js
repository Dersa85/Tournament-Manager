"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[433],{433:(L,_,c)=>{c.r(_),c.d(_,{OrganizationModule:()=>Y});var M=c(9557),l=c(8583),u=c(3679),t=c(7716),O=c(6215),d=c(2326);let C=(()=>{class r{constructor(o){this.socket=o,this.groups$=new O.X({}),o.on("allGroups",e=>{this.groups$.next(e)})}get groups(){return this.groups$}createNewGroup(o){this.socket.emit("createNewGroup",o)}editGroup(o,e){this.socket.emit("editGroup",o,e)}}return r.\u0275fac=function(o){return new(o||r)(t.LFG(d.sk))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var m=c(3423),Z=c(2238),f=c(8295),T=c(9983),h=c(1095),A=c(8590),b=c(1552);function P(r,i){if(1&r){const o=t.EpF();t.TgZ(0,"th"),t.TgZ(1,"div",12),t.TgZ(2,"button",13),t.NdJ("mouseenter",function(){const n=t.CHM(o).index;return t.oxw().setMouseHoverColumn(n)})("mouseleave",function(){return t.CHM(o),t.oxw().setMouseHoverColumn(-1)})("click",function(){const n=t.CHM(o).index;return t.oxw().removeColumn(n)}),t.TgZ(3,"mat-icon"),t._uU(4,"delete"),t.qZA(),t.qZA(),t.TgZ(5,"mat-form-field",3),t.TgZ(6,"mat-label"),t._uU(7),t.qZA(),t._UZ(8,"input",14),t.qZA(),t.qZA(),t.qZA()}if(2&r){const o=i.index,e=t.oxw();t.ekj("hoverColumn",o==e.hoverColumn)("borderBottom",o==e.hoverColumn&&0==e.memberValuesArrays.length),t.xp6(7),t.hij("Kategorie ",o+1,""),t.xp6(1),t.Q6J("formControlName",o)}}function x(r,i){if(1&r&&(t.TgZ(0,"td",17),t.TgZ(1,"mat-form-field",3),t.TgZ(2,"mat-label"),t._uU(3,"Wert"),t.qZA(),t._UZ(4,"input",18),t.qZA(),t.qZA()),2&r){const o=i.index,e=i.last,s=i.first,n=t.oxw(),a=n.last,p=n.index,g=t.oxw();t.ekj("hoverColumn",o==g.hoverColumn)("lastColumn",o==g.hoverColumn&&a)("hoverRow",p==g.hoverRow)("hoverRowFirst",p==g.hoverRow&&s)("hoverRowLast",p==g.hoverRow&&e),t.xp6(4),t.Q6J("formControl",g.getMemberValue(p,o))}}function y(r,i){if(1&r){const o=t.EpF();t.TgZ(0,"tr"),t.YNc(1,x,5,11,"td",15),t.TgZ(2,"button",16),t.NdJ("mouseenter",function(){const n=t.CHM(o).index;return t.oxw().setMouseHoverRow(n)})("mouseleave",function(){return t.CHM(o),t.oxw().setMouseHoverRow(-1)})("click",function(){const n=t.CHM(o).index;return t.oxw().removeMember(n)}),t.TgZ(3,"mat-icon"),t._uU(4,"delete"),t.qZA(),t.qZA(),t.qZA()}if(2&r){const o=i.index,e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.getMember(o).controls)}}let v=(()=>{class r{constructor(o,e,s,n,a){this.fb=o,this.groupService=e,this.socket=s,this.router=n,this.route=a,this.hoverColumn=-1,this.hoverRow=-1,this.isLoadingGroup=!1,this.form=this.fb.group({groupName:this.fb.control("",[u.kI.required,u.kI.minLength(3)],[]),titles:this.fb.array([this.createEmptyControl()]),memberValuesArrays:this.fb.array([])})}ngOnInit(){const o=this.route.snapshot.params.id;null!=o&&(this.isLoadingGroup=!0,this.socket.on(`getGroup/${o}`,e=>{this.isLoadingGroup&&(this.loadGroupInForm(e),this.isLoadingGroup=!1)})),this.socket.emit("loadGroup",o)}loadGroupInForm(o){this.form.controls.groupName.setValue(o.groupName),this.updateForEachRow(o)}updateForEachRow(o){for(let e=0;e<o.memberValuesArrays.length;e++)this.memberValuesArrays.length<e+1&&this.addMember(),this.updateForEachColum(e,o)}updateForEachColum(o,e){const s=e.memberValuesArrays[o];for(let n=0;n<s.length;n++){const a=e.titles[n];this.titles.length<n+1&&this.addColumn(),this.titles.controls[n].setValue(a),this.memberValuesArrays.controls[o].controls[n].setValue(s[n])}}get titles(){return this.form.get("titles")}get memberValuesArrays(){return this.form.get("memberValuesArrays")}get groupName(){return this.form.get("groupName")}getMember(o){return this.memberValuesArrays.controls[o]}getMemberValue(o,e){return this.getMember(o).controls[e]}createEmptyArray(){return this.fb.array([],[],[])}createEmptyControl(){return this.fb.control("",[u.kI.required],[])}addMemberValue(o){this.memberValuesArrays.controls[o].push(this.createEmptyControl())}addMember(){this.memberValuesArrays.push(this.createEmptyArray());const o=this.titles.length,s=this.memberValuesArrays.controls[this.memberValuesArrays.length-1];for(let n=0;n<o;n++)s.push(this.createEmptyControl())}removeMember(o){this.memberValuesArrays.removeAt(o)}addColumn(){this.titles.push(this.createEmptyControl());for(let o=0;o<this.memberValuesArrays.controls.length;o++)this.addMemberValue(o)}removeColumn(o){this.titles.removeAt(o),this.memberValuesArrays.controls.forEach(e=>{e.removeAt(o)})}saveForm(){const o=this.route.snapshot.params.id,e=this.form.value;o?this.groupService.editGroup(o,e):this.groupService.createNewGroup(e),this.navigateBack()}navigateBack(){let e="./..";this.route.snapshot.params.id&&(e="./../.."),this.router.navigate([e],{relativeTo:this.route})}setMouseHoverRow(o){this.hoverRow=o}setMouseHoverColumn(o){this.hoverColumn=o}}return r.\u0275fac=function(o){return new(o||r)(t.Y36(u.qu),t.Y36(C),t.Y36(d.sk),t.Y36(m.F0),t.Y36(m.gz))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-group-editor"]],decls:23,vars:4,consts:[["mat-dialog-title",""],[1,"group"],[3,"formGroup"],["appearance","legacy"],["matInput","","placeholder","Gruppenname","formControlName","groupName"],["formArrayName","titles"],[3,"hoverColumn","borderBottom",4,"ngFor","ngForOf"],["mat-icon-button","","matTooltip","Kategorie hinzuf\xfcgen",1,"add-cart-btn",3,"click"],[4,"ngFor","ngForOf"],["mat-icon-button","","matTooltip","Teilnehmer hinzuf\xfcgen",3,"click"],["mat-button","",3,"click"],["mat-button","",3,"disabled","click"],[1,"table-header"],["mat-icon-button","","matTooltip","Kategorie l\xf6schen",3,"mouseenter","mouseleave","click"],["matInput","","placeholder","Kategorie",3,"formControlName"],["formArray","i",3,"hoverColumn","lastColumn","hoverRow","hoverRowFirst","hoverRowLast",4,"ngFor","ngForOf"],["mat-icon-button","","matTooltip","Teilnehmer l\xf6schen",3,"mouseenter","mouseleave","click"],["formArray","i"],["matInput","","placeholder","Wert",3,"formControl"]],template:function(o,e){1&o&&(t.TgZ(0,"h2",0),t._uU(1,"Gruppen Editor"),t.qZA(),t.TgZ(2,"div",1),t.TgZ(3,"form",2),t.TgZ(4,"mat-form-field",3),t.TgZ(5,"mat-label"),t._uU(6,"Gruppenname"),t.qZA(),t._UZ(7,"input",4),t.qZA(),t.TgZ(8,"table"),t.TgZ(9,"tr",5),t.YNc(10,P,9,6,"th",6),t.TgZ(11,"button",7),t.NdJ("click",function(){return e.addColumn()}),t.TgZ(12,"mat-icon"),t._uU(13,"add_chart"),t.qZA(),t.qZA(),t.qZA(),t.YNc(14,y,5,1,"tr",8),t.qZA(),t.TgZ(15,"button",9),t.NdJ("click",function(){return e.addMember()}),t.TgZ(16,"mat-icon"),t._uU(17,"person_add"),t.qZA(),t.qZA(),t.TgZ(18,"div"),t.TgZ(19,"button",10),t.NdJ("click",function(){return e.navigateBack()}),t._uU(20,"Abbrechen"),t.qZA(),t.TgZ(21,"button",11),t.NdJ("click",function(){return e.saveForm()}),t._uU(22,"Speichern"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o&&(t.xp6(3),t.Q6J("formGroup",e.form),t.xp6(7),t.Q6J("ngForOf",e.titles.controls),t.xp6(4),t.Q6J("ngForOf",e.memberValuesArrays.controls),t.xp6(7),t.Q6J("disabled",e.form.invalid))},directives:[Z.uh,u._Y,u.JL,u.sg,f.KE,f.hX,T.Nt,u.Fj,u.JJ,u.u,u.CE,l.sg,h.lW,A.gM,b.Hw,u.oH],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;margin:1rem}[_nghost-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]   .group[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .group[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-width:2px;border-top-left-radius:1rem;border-top-right-radius:1rem;border-style:dotted;border-color:transparent}[_nghost-%COMP%]   .group[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.hoverColumn[_ngcontent-%COMP%]{border-top-color:red;border-left-color:red;border-right-color:red}[_nghost-%COMP%]   .group[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.borderBottom[_ngcontent-%COMP%]{border-bottom-color:red;border-bottom-left-radius:1rem;border-bottom-right-radius:1rem}[_nghost-%COMP%]   .group[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}[_nghost-%COMP%]   .group[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   .add-cart-btn[_ngcontent-%COMP%]{margin:2rem 0 0}[_nghost-%COMP%]   .group[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-width:2px;border-style:dotted;border-color:transparent}[_nghost-%COMP%]   .group[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.hoverColumn[_ngcontent-%COMP%]{border-left-color:red;border-right-color:red}[_nghost-%COMP%]   .group[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.hoverRow[_ngcontent-%COMP%]{border-top-color:red;border-bottom-color:red}[_nghost-%COMP%]   .group[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.lastColumn[_ngcontent-%COMP%]{border-bottom-color:red;border-bottom-left-radius:1rem;border-bottom-right-radius:1rem}[_nghost-%COMP%]   .group[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.hoverRowFirst[_ngcontent-%COMP%]{border-left-color:red;border-top-left-radius:1rem;border-bottom-left-radius:1rem}[_nghost-%COMP%]   .group[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.hoverRowLast[_ngcontent-%COMP%]{border-right-color:red;border-top-right-radius:1rem;border-bottom-right-radius:1rem}"]}),r})();var G=c(7556);function k(r,i){if(1&r){const o=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){t.CHM(o);const s=t.oxw().$implicit;return t.oxw().editGroup(s.key)}),t.TgZ(1,"mat-icon"),t._uU(2,"edit"),t.qZA(),t.qZA()}}function F(r,i){if(1&r){const o=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"button",3),t.NdJ("click",function(){const n=t.CHM(o).$implicit;return t.oxw().openGroup(n.key)}),t._uU(2),t.qZA(),t.YNc(3,k,3,0,"button",4),t.ALo(4,"async"),t.qZA()}if(2&r){const o=i.$implicit,e=t.oxw();t.xp6(2),t.Oqu(o.value.groupName),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,2,e.authService.isLogged))}}function E(r,i){if(1&r){const o=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){return t.CHM(o),t.oxw().goToCategoryEditor()}),t._uU(1,"Neue Kategorie"),t.qZA()}}let N=(()=>{class r{constructor(o,e,s,n,a){this.groupService=o,this.router=e,this.route=s,this.socket=n,this.authService=a,this.socket.emit("getAllGroups"),this.groups$=this.groupService.groups}goToCategoryEditor(){this.router.navigate(["group-editor"],{relativeTo:this.route})}openGroup(o){this.router.navigate(["group",o],{relativeTo:this.route})}editGroup(o){this.router.navigate(["group-editor",o],{relativeTo:this.route})}navigateBack(){this.router.navigate(["./.."],{relativeTo:this.route})}}return r.\u0275fac=function(o){return new(o||r)(t.Y36(C),t.Y36(m.F0),t.Y36(m.gz),t.Y36(d.sk),t.Y36(G.e))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-organization"]],decls:9,vars:8,consts:[[4,"ngFor","ngForOf"],["class","control-btn","mat-raised-button","",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",1,"control-btn",3,"click"],["mat-stroked-button","",1,"group-btn",3,"click"],["mat-icon-button","",3,"click",4,"ngIf"],["mat-icon-button","",3,"click"],["mat-raised-button","",1,"control-btn",3,"click"]],template:function(o,e){1&o&&(t.TgZ(0,"h1"),t._uU(1,"Gruppen"),t.qZA(),t.YNc(2,F,5,4,"div",0),t.ALo(3,"keyvalue"),t.ALo(4,"async"),t.YNc(5,E,2,0,"button",1),t.ALo(6,"async"),t.TgZ(7,"button",2),t.NdJ("click",function(){return e.navigateBack()}),t._uU(8,"Zur\xfcck"),t.qZA()),2&o&&(t.xp6(2),t.Q6J("ngForOf",t.lcZ(3,2,t.lcZ(4,4,e.groups$))),t.xp6(3),t.Q6J("ngIf",t.lcZ(6,6,e.authService.isLogged)))},directives:[l.sg,l.O5,h.lW,b.Hw],pipes:[l.Nd,l.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}[_nghost-%COMP%]   .group-btn[_ngcontent-%COMP%]{margin:0 0 .5rem}[_nghost-%COMP%]   .control-btn[_ngcontent-%COMP%]{margin:.5rem 0 0}"]}),r})();var w=c(8002),V=c(3342);function q(r,i){if(1&r&&(t.TgZ(0,"th"),t._uU(1),t.qZA()),2&r){const o=i.$implicit;t.xp6(1),t.hij(" ",o," ")}}function J(r,i){if(1&r&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&r){const o=i.$implicit;t.xp6(1),t.hij(" ",o," ")}}function z(r,i){if(1&r&&(t.TgZ(0,"tr"),t.YNc(1,J,2,1,"td",1),t.qZA()),2&r){const o=i.$implicit;t.xp6(1),t.Q6J("ngForOf",o)}}const R=[{path:"",component:N},{path:"group-editor",component:v},{path:"group-editor/:id",component:v},{path:"group/:id",component:(()=>{class r{constructor(o,e,s){this.router=o,this.route=e,this.socket=s;const n=this.route.snapshot.params.id;this.group$=this.socket.fromEvent(`getGroup/${n}`),this.members$=this.group$.pipe((0,w.U)(a=>a.memberValuesArrays),(0,V.b)(()=>console.log("TAP"))),this.socket.emit("loadGroup",n)}ngOnInit(){}navigateBack(){this.router.navigate(["./../.."],{relativeTo:this.route})}}return r.\u0275fac=function(o){return new(o||r)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(d.sk))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-group"]],decls:12,vars:9,consts:[[1,"tabel-container"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","accent",3,"click"]],template:function(o,e){if(1&o&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"async"),t.qZA(),t.TgZ(3,"div",0),t.TgZ(4,"table"),t.TgZ(5,"tr"),t.YNc(6,q,2,1,"th",1),t.ALo(7,"async"),t.qZA(),t.YNc(8,z,2,1,"tr",1),t.ALo(9,"async"),t.qZA(),t.qZA(),t.TgZ(10,"button",2),t.NdJ("click",function(){return e.navigateBack()}),t._uU(11,"Zur\xfcck"),t.qZA()),2&o){let s,n,a;t.xp6(1),t.hij("Gruppe: ",null==(s=t.lcZ(2,3,e.group$))?null:s.groupName,""),t.xp6(5),t.Q6J("ngForOf",null==(n=t.lcZ(7,5,e.group$))?null:n.titles),t.xp6(2),t.Q6J("ngForOf",null==(a=t.lcZ(9,7,e.group$))?null:a.memberValuesArrays)}},directives:[l.sg,h.lW],pipes:[l.Ov],styles:["[_nghost-%COMP%]{display:flex;width:calc(100vw - 1rem);flex-direction:column;margin:1rem 0 0 1rem;justify-content:center}[_nghost-%COMP%] > *[_ngcontent-%COMP%]{margin:auto}[_nghost-%COMP%]   .tabel-container[_ngcontent-%COMP%]{margin-top:1rem;margin-bottom:1rem}"]}),r})()}];let U=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[m.Bz.forChild(R)],m.Bz]}),r})(),Y=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[l.ez,U,M.q,u.u5,u.UX]]}),r})()}}]);